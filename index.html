<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>LED Ticker</title>
  <style>
    /* Electronic-looking font (fallback to monospace if blocked) */
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap');

    :root{
      --px-per-sec: 80;   /* base speed in pixels/sec */
      --gap: 48px;        /* space between repeats */
      --led: #ff2a2a;     /* ðŸ”´ red LED color */
    }

    html, body {
      margin: 0;
      height: 100%;
      background: transparent;
    }

    .ticker-wrap{
      position: relative;
      width: 100%;
      height: 40px;
      overflow: hidden;
      box-sizing: border-box;
      mask-image: linear-gradient(to right, transparent 0, black 5%, black 95%, transparent 100%);
    }

    .ticker {
      position: absolute;
      display: flex;
      gap: var(--gap);
      will-change: transform;
    }

    .item {
      white-space: nowrap;
      font-family: 'Orbitron', monospace;
      font-size: 22px;
      line-height: 40px;
      color: var(--led);
      /* LED red glow */
      text-shadow: 0 0 4px var(--led), 0 0 8px var(--led), 0 0 12px var(--led);
    }

    @keyframes scroll {
      from { transform: translateX(0); }
      to   { transform: translateX(-50%); }
    }

    .running {
      animation-name: scroll;
      animation-timing-function: linear;
      animation-iteration-count: infinite;
    }
  </style>
</head>
<body>
  <div class="ticker-wrap">
    <div id="track" class="ticker">
      <span class="item" id="a"></span>
      <span class="item" id="b"></span>
      <span class="item" id="a2" aria-hidden="true"></span>
      <span class="item" id="b2" aria-hidden="true"></span>
    </div>
  </div>

  <script>
    const track = document.getElementById('track');
    const a = document.getElementById('a');
    const b = document.getElementById('b');
    const a2 = document.getElementById('a2');
    const b2 = document.getElementById('b2');

    async function fetchMessage(){
      try {
        const res = await fetch('message.txt?' + Date.now());
        if (!res.ok) throw new Error('HTTP ' + res.status);
        return (await res.text()).trim() || ' ';
      } catch (e) {
        console.error('Fetch failed:', e);
        return 'â€” unable to load message.txt â€”';
      }
    }

    function setText(text){
      const padded = text.length < 10 ? `   ${text}   ` : text;
      a.textContent = padded;
      b.textContent = padded;
      a2.textContent = padded;
      b2.textContent = padded;
    }

    function measureAndAnimate(){
      track.classList.remove('running');
      track.style.animationDuration = '';
      void track.offsetWidth;

      const firstHalfWidth = a.offsetWidth + b.offsetWidth + parseFloat(getComputedStyle(track).gap || 0);
      const pxPerSec = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--px-per-sec')) || 80;
      const duration = Math.max(6, firstHalfWidth / pxPerSec);

      track.style.animationDuration = duration + 's';
      track.classList.add('running');
    }

    async function update(){
      const text = await fetchMessage();
      setText(text);
      measureAndAnimate();
    }

    update();
    setInterval(update, 5000);
    addEventListener('resize', measureAndAnimate);
  </script>
</body>
</html>
